services:
  - type: web
    name: wms01-backend
    env: node
    rootDir: server
    buildCommand: npm install
    startCommand: npm start
    autoDeploy: true
    healthCheckPath: /health
    envVars:
      - key: SUPABASE_URL
        fromSecret: supabase_url
      - key: SUPABASE_SERVICE_ROLE_KEY
        fromSecret: supabase_service_role_key
      - key: APP_JWT_SECRET
        fromSecret: app_jwt_secret
      - key: CORS_ORIGINS
        fromSecret: cors_origins
  - type: static_site
    name: wms01-frontend
    rootDir: .
    buildCommand: npm install && npm run build
    publishPath: dist
    autoDeploy: true
    envVars:
      - key: VITE_SUPABASE_URL
        fromSecret: vite_supabase_url
      - key: VITE_SUPABASE_ANON_KEY
        fromSecret: vite_supabase_anon_key
      - key: VITE_AUTH_BACKEND_URL
        fromSecret: vite_auth_backend_url